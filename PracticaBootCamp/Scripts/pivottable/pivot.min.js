(function(){var r,t=[].indexOf||function(n){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===n)return t;return-1},u=[].slice,i=function(n,t){return function(){return n.apply(t,arguments)}},n={}.hasOwnProperty;r=function(n){return typeof exports=="object"&&typeof module=="object"?n(require("jquery")):typeof define=="function"&&define.amd?define(["jquery"],n):n(jQuery)};r(function(r){var v,k,y,p,d,g,w,e,nt,l,a,s,b,tt,f,h,o,c;return k=function(n,t,i){var f,u,r,e;for(n+="",u=n.split("."),r=u[0],e=u.length>1?i+u[1]:"",f=/(\d+)(\d{3})/;f.test(r);)r=r.replace(f,"$1"+t+"$2");return r+e},a=function(n){var t;return t={digitsAfterDecimal:2,scaler:1,thousandsSep:",",decimalSep:".",prefix:"",suffix:"",showZero:!1},n=r.extend(t,n),function(t){var i;return isNaN(t)||!isFinite(t)?"":t===0&&!n.showZero?"":(i=k((n.scaler*t).toFixed(n.digitsAfterDecimal),n.thousandsSep,n.decimalSep),""+n.prefix+i+n.suffix)}},f=a(),h=a({digitsAfterDecimal:0}),o=a({digitsAfterDecimal:1,scaler:100,suffix:"%"}),y={count:function(n){return n==null&&(n=h),function(){return function(){return{count:0,push:function(){return this.count++},value:function(){return this.count},format:n}}}},countUnique:function(n){return n==null&&(n=h),function(i){var r;return r=i[0],function(){return{uniq:[],push:function(n){var i;if(i=n[r],t.call(this.uniq,i)<0)return this.uniq.push(n[r])},value:function(){return this.uniq.length},format:n,numInputs:r!=null?0:1}}}},listUnique:function(n){return function(i){var r;return r=i[0],function(){return{uniq:[],push:function(n){var i;if(i=n[r],t.call(this.uniq,i)<0)return this.uniq.push(n[r])},value:function(){return this.uniq.join(n)},format:function(n){return n},numInputs:r!=null?0:1}}}},sum:function(n){return n==null&&(n=f),function(t){var i;return i=t[0],function(){return{sum:0,push:function(n){if(!isNaN(parseFloat(n[i])))return this.sum+=parseFloat(n[i])},value:function(){return this.sum},format:n,numInputs:i!=null?0:1}}}},min:function(n){return n==null&&(n=f),function(t){var i;return i=t[0],function(){return{val:null,push:function(n){var r,t;return t=parseFloat(n[i]),isNaN(t)?void 0:this.val=Math.min(t,(r=this.val)!=null?r:t)},value:function(){return this.val},format:n,numInputs:i!=null?0:1}}}},max:function(n){return n==null&&(n=f),function(t){var i;return i=t[0],function(){return{val:null,push:function(n){var r,t;return t=parseFloat(n[i]),isNaN(t)?void 0:this.val=Math.max(t,(r=this.val)!=null?r:t)},value:function(){return this.val},format:n,numInputs:i!=null?0:1}}}},average:function(n){return n==null&&(n=f),function(t){var i;return i=t[0],function(){return{sum:0,len:0,push:function(n){if(!isNaN(parseFloat(n[i])))return this.sum+=parseFloat(n[i]),this.len++},value:function(){return this.sum/this.len},format:n,numInputs:i!=null?0:1}}}},sumOverSum:function(n){return n==null&&(n=f),function(t){var i,r;return r=t[0],i=t[1],function(){return{sumNum:0,sumDenom:0,push:function(n){return isNaN(parseFloat(n[r]))||(this.sumNum+=parseFloat(n[r])),isNaN(parseFloat(n[i]))?void 0:this.sumDenom+=parseFloat(n[i])},value:function(){return this.sumNum/this.sumDenom},format:n,numInputs:r!=null&&i!=null?0:2}}}},sumOverSumBound80:function(n,t){return n==null&&(n=!0),t==null&&(t=f),function(i){var r,u;return u=i[0],r=i[1],function(){return{sumNum:0,sumDenom:0,push:function(n){return isNaN(parseFloat(n[u]))||(this.sumNum+=parseFloat(n[u])),isNaN(parseFloat(n[r]))?void 0:this.sumDenom+=parseFloat(n[r])},value:function(){var t;return t=n?1:-1,(.821187207574908/this.sumDenom+this.sumNum/this.sumDenom+1.2815515655446004*t*Math.sqrt(.410593603787454/(this.sumDenom*this.sumDenom)+this.sumNum*(1-this.sumNum/this.sumDenom)/(this.sumDenom*this.sumDenom)))/(1+1.6423744151498161/this.sumDenom)},format:t,numInputs:u!=null&&r!=null?0:2}}}},fractionOf:function(n,t,i){return t==null&&(t="total"),i==null&&(i=o),function(){var r;return r=1<=arguments.length?u.call(arguments,0):[],function(u,f,e){return{selector:{total:[[],[]],row:[f,[]],col:[[],e]}[t],inner:n.apply(null,r)(u,f,e),push:function(n){return this.inner.push(n)},format:i,value:function(){return this.inner.value()/u.getAggregator.apply(u,this.selector).inner.value()},numInputs:n.apply(null,r)().numInputs}}}}},p=function(n){return{Count:n.count(h),"Count Unique Values":n.countUnique(h),"List Unique Values":n.listUnique(", "),Sum:n.sum(f),"Integer Sum":n.sum(h),Average:n.average(f),Minimum:n.min(f),Maximum:n.max(f),"Sum over Sum":n.sumOverSum(f),"80% Upper Bound":n.sumOverSumBound80(!0,f),"80% Lower Bound":n.sumOverSumBound80(!1,f),"Sum as Fraction of Total":n.fractionOf(n.sum(),"total",o),"Sum as Fraction of Rows":n.fractionOf(n.sum(),"row",o),"Sum as Fraction of Columns":n.fractionOf(n.sum(),"col",o),"Count as Fraction of Total":n.fractionOf(n.count(),"total",o),"Count as Fraction of Rows":n.fractionOf(n.count(),"row",o),"Count as Fraction of Columns":n.fractionOf(n.count(),"col",o)}}(y),b={Table:function(n,t){return s(n,t)},"Table Barchart":function(n,t){return r(s(n,t)).barchart()},Heatmap:function(n,t){return r(s(n,t)).heatmap()},"Row Heatmap":function(n,t){return r(s(n,t)).heatmap("rowheatmap")},"Col Heatmap":function(n,t){return r(s(n,t)).heatmap("colheatmap")}},e={en:{aggregators:p,renderers:b,localeStrings:{renderError:"An error occurred rendering the PivotTable results.",computeError:"An error occurred computing the PivotTable results.",uiRenderError:"An error occurred rendering the PivotTable UI.",selectAll:"Select All",selectNone:"Select None",tooMany:"(too many to list)",filterResults:"Filter results",totals:"Totals",vs:"vs",by:"by"}}},nt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],d=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],c=function(n){return("0"+n).substr(-2,2)},g={bin:function(n,t){return function(i){return i[n]-i[n]%t}},dateFormat:function(n,t,i,r,u){var f;return i==null&&(i=!1),r==null&&(r=nt),u==null&&(u=d),f=i?"UTC":"",function(i){var e;return(e=new Date(Date.parse(i[n])),isNaN(e))?"":t.replace(/%(.)/g,function(n,t){switch(t){case"y":return e["get"+f+"FullYear"]();case"m":return c(e["get"+f+"Month"]()+1);case"n":return r[e["get"+f+"Month"]()];case"d":return c(e["get"+f+"Date"]());case"w":return u[e["get"+f+"Day"]()];case"x":return e["get"+f+"Day"]();case"H":return c(e["get"+f+"Hours"]());case"M":return c(e["get"+f+"Minutes"]());case"S":return c(e["get"+f+"Seconds"]());default:return"%"+t}})}}},l=function(){return function(n,t){var i,u,r,f,e,o,s;if(o=/(\d+)|(\D+)/g,e=/\d/,s=/^0/,typeof n=="number"||typeof t=="number")return isNaN(n)?1:isNaN(t)?-1:n-t;if(i=String(n).toLowerCase(),r=String(t).toLowerCase(),i===r)return 0;if(!(e.test(i)&&e.test(r)))return i>r?1:-1;for(i=i.match(o),r=r.match(o);i.length&&r.length;)if(u=i.shift(),f=r.shift(),u!==f)return e.test(u)&&e.test(f)?u.replace(s,".0")-f.replace(s,".0"):u>f?1:-1;return i.length-r.length}}(this),tt=function(n){var i,t,r;t={};for(i in n)r=n[i],t[r]=i;return function(n,i){return t[n]!=null&&t[i]!=null?t[n]-t[i]:t[n]!=null?-1:t[i]!=null?1:l(n,i)}},w=function(n,t){var i;return i=n(t),r.isFunction(i)?i:l},r.pivotUtilities={aggregatorTemplates:y,aggregators:p,renderers:b,derivers:g,locales:e,naturalSort:l,numberFormat:a,sortAs:tt},v=function(){function t(n,r){this.getAggregator=i(this.getAggregator,this);this.getRowKeys=i(this.getRowKeys,this);this.getColKeys=i(this.getColKeys,this);this.sortKeys=i(this.sortKeys,this);this.arrSort=i(this.arrSort,this);this.aggregator=r.aggregator;this.aggregatorName=r.aggregatorName;this.colAttrs=r.cols;this.rowAttrs=r.rows;this.valAttrs=r.vals;this.sorters=r.sorters;this.tree={};this.rowKeys=[];this.colKeys=[];this.rowTotals={};this.colTotals={};this.allTotal=this.aggregator(this,[],[]);this.sorted=!1;t.forEachRecord(n,r.derivedAttributes,function(n){return function(t){if(r.filter(t))return n.processRecord(t)}}(this))}return t.forEachRecord=function(t,i,u){var e,y,o,s,p,h,w,f,c,l,a,v;if(e=r.isEmptyObject(i)?u:function(n){var t,r,f;for(t in i)f=i[t],n[t]=(r=f(n))!=null?r:n[t];return u(n)},r.isFunction(t))return t(e);if(r.isArray(t)){if(r.isArray(t[0])){l=[];for(o in t)if(n.call(t,o)&&(y=t[o],o>0)){f={};c=t[0];for(s in c)n.call(c,s)&&(p=c[s],f[p]=y[s]);l.push(e(f))}return l}for(a=[],h=0,w=t.length;h<w;h++)f=t[h],a.push(e(f));return a}if(t instanceof jQuery)return v=[],r("thead > tr > th",t).each(function(){return v.push(r(this).text())}),r("tbody > tr",t).each(function(){return f={},r("td",this).each(function(n){return f[v[n]]=r(this).html()}),e(f)});throw new Error("unknown input format");},t.convertToArray=function(n){var i;return i=[],t.forEachRecord(n,{},function(n){return i.push(n)}),i},t.prototype.arrSort=function(n){var i,t;return t=function(){var t,u,r;for(r=[],t=0,u=n.length;t<u;t++)i=n[t],r.push(w(this.sorters,i));return r}.call(this),function(n,i){var u,r,f;for(r in t)if(f=t[r],u=f(n[r],i[r]),u!==0)return u;return 0}},t.prototype.sortKeys=function(){if(!this.sorted)return this.sorted=!0,this.rowKeys.sort(this.arrSort(this.rowAttrs)),this.colKeys.sort(this.arrSort(this.colAttrs))},t.prototype.getColKeys=function(){return this.sortKeys(),this.colKeys},t.prototype.getRowKeys=function(){return this.sortKeys(),this.rowKeys},t.prototype.processRecord=function(n){var i,u,t,f,c,l,e,s,a,h,v,r,o;for(i=[],r=[],s=this.colAttrs,f=0,c=s.length;f<c;f++)o=s[f],i.push((a=n[o])!=null?a:"null");for(h=this.rowAttrs,e=0,l=h.length;e<l;e++)o=h[e],r.push((v=n[o])!=null?v:"null");return t=r.join(String.fromCharCode(0)),u=i.join(String.fromCharCode(0)),this.allTotal.push(n),r.length!==0&&(this.rowTotals[t]||(this.rowKeys.push(r),this.rowTotals[t]=this.aggregator(this,r,[])),this.rowTotals[t].push(n)),i.length!==0&&(this.colTotals[u]||(this.colKeys.push(i),this.colTotals[u]=this.aggregator(this,[],i)),this.colTotals[u].push(n)),i.length!==0&&r.length!==0?(this.tree[t]||(this.tree[t]={}),this.tree[t][u]||(this.tree[t][u]=this.aggregator(this,r,i)),this.tree[t][u].push(n)):void 0},t.prototype.getAggregator=function(n,t){var i,r,u;return u=n.join(String.fromCharCode(0)),r=t.join(String.fromCharCode(0)),i=n.length===0&&t.length===0?this.allTotal:n.length===0?this.colTotals[r]:t.length===0?this.rowTotals[u]:this.tree[u][r],i!=null?i:{value:function(){return null},format:function(){return""}}},t}(),s=function(t,i){var d,nt,a,p,h,tt,s,e,it,v,l,w,b,g,f,u,y,o,rt,c,k;tt={localeStrings:{totals:"Totals"}};i=r.extend(tt,i);a=t.colAttrs;l=t.rowAttrs;b=t.getRowKeys();h=t.getColKeys();v=document.createElement("table");v.className="pvtTable";g=function(n,t,i){var u,f,e,h,o,s,c,r;if(t!==0){for(h=!0,r=u=0,o=i;0<=o?u<=o:u>=o;r=0<=o?++u:--u)n[t-1][r]!==n[t][r]&&(h=!1);if(h)return-1}for(f=0;t+f<n.length;){for(c=!1,r=e=0,s=i;0<=s?e<=s:e>=s;r=0<=s?++e:--e)n[t][r]!==n[t+f][r]&&(c=!0);if(c)break;f++}return f};for(e in a)if(n.call(a,e)){nt=a[e];o=document.createElement("tr");parseInt(e)===0&&l.length!==0&&(u=document.createElement("th"),u.setAttribute("colspan",l.length),u.setAttribute("rowspan",a.length),o.appendChild(u));u=document.createElement("th");u.className="pvtAxisLabel";u.innerHTML=nt;o.appendChild(u);for(s in h)n.call(h,s)&&(p=h[s],k=g(h,parseInt(s),parseInt(e)),k!==-1&&(u=document.createElement("th"),u.className="pvtColLabel",u.innerHTML=p[e],u.setAttribute("colspan",k),parseInt(e)===a.length-1&&l.length!==0&&u.setAttribute("rowspan",2),o.appendChild(u)));parseInt(e)===0&&(u=document.createElement("th"),u.className="pvtTotalLabel",u.innerHTML=i.localeStrings.totals,u.setAttribute("rowspan",a.length+(l.length===0?0:1)),o.appendChild(u));v.appendChild(o)}if(l.length!==0){o=document.createElement("tr");for(s in l)n.call(l,s)&&(it=l[s],u=document.createElement("th"),u.className="pvtAxisLabel",u.innerHTML=it,o.appendChild(u));u=document.createElement("th");a.length===0&&(u.className="pvtTotalLabel",u.innerHTML=i.localeStrings.totals);o.appendChild(u);v.appendChild(o)}for(s in b)if(n.call(b,s)){w=b[s];o=document.createElement("tr");for(e in w)n.call(w,e)&&(rt=w[e],k=g(b,parseInt(s),parseInt(e)),k!==-1&&(u=document.createElement("th"),u.className="pvtRowLabel",u.innerHTML=rt,u.setAttribute("rowspan",k),parseInt(e)===l.length-1&&a.length!==0&&u.setAttribute("colspan",2),o.appendChild(u)));for(e in h)n.call(h,e)&&(p=h[e],d=t.getAggregator(w,p),c=d.value(),f=document.createElement("td"),f.className="pvtVal row"+s+" col"+e,f.innerHTML=d.format(c),f.setAttribute("data-value",c),o.appendChild(f));y=t.getAggregator(w,[]);c=y.value();f=document.createElement("td");f.className="pvtTotal rowTotal";f.innerHTML=y.format(c);f.setAttribute("data-value",c);f.setAttribute("data-for","row"+s);o.appendChild(f);v.appendChild(o)}o=document.createElement("tr");u=document.createElement("th");u.className="pvtTotalLabel";u.innerHTML=i.localeStrings.totals;u.setAttribute("colspan",l.length+(a.length===0?0:1));o.appendChild(u);for(e in h)n.call(h,e)&&(p=h[e],y=t.getAggregator([],p),c=y.value(),f=document.createElement("td"),f.className="pvtTotal colTotal",f.innerHTML=y.format(c),f.setAttribute("data-value",c),f.setAttribute("data-for","col"+e),o.appendChild(f));return y=t.getAggregator([],[]),c=y.value(),f=document.createElement("td"),f.className="pvtGrandTotal",f.innerHTML=y.format(c),f.setAttribute("data-value",c),o.appendChild(f),v.appendChild(o),v.setAttribute("data-numrows",b.length),v.setAttribute("data-numcols",h.length),v},r.fn.pivot=function(n,t){var o,u,h,i,f;o={cols:[],rows:[],vals:[],filter:function(){return!0},aggregator:y.count()(),aggregatorName:"Count",sorters:function(){},derivedAttributes:{},renderer:s,rendererOptions:null,localeStrings:e.en.localeStrings};t=r.extend(o,t);i=null;try{h=new v(n,t);try{i=t.renderer(h,t.rendererOptions)}catch(c){u=c;typeof console!="undefined"&&console!==null&&console.error(u.stack);i=r("<span>").html(t.localeStrings.renderError)}}catch(c){u=c;typeof console!="undefined"&&console!==null&&console.error(u.stack);i=r("<span>").html(t.localeStrings.computeError)}for(f=this[0];f.hasChildNodes();)f.removeChild(f.lastChild);return this.append(i)},r.fn.pivotUI=function(i,u,f,o){var ni,p,ct,nt,y,tt,ti,ii,lt,ri,b,at,h,it,ui,fi,ei,oi,rt,ut,s,ft,et,vt,yt,pt,wt,bt,k,si,ot,st,a,d,kt,dt,g,gt,ht,c;f==null&&(f=!1);o==null&&(o="en");e[o]==null&&(o="en");ti={derivedAttributes:{},aggregators:e[o].aggregators,renderers:e[o].renderers,hiddenAttributes:[],menuLimit:200,cols:[],rows:[],vals:[],exclusions:{},inclusions:{},unusedAttrsVertical:85,autoSortUnusedAttrs:!1,rendererOptions:{localeStrings:e[o].localeStrings},onRefresh:null,filter:function(){return!0},sorters:function(){},localeStrings:e[o].localeStrings};lt=this.data("pivotUIOptions");s=lt==null||f?r.extend(ti,u):lt;try{i=v.convertToArray(i);d=function(){var t,r;t=i[0];r=[];for(h in t)n.call(t,h)&&r.push(h);return r}();vt=s.derivedAttributes;for(y in vt)n.call(vt,y)&&t.call(d,y)<0&&d.push(y);for(nt={},it=0,ui=d.length;it<ui;it++)c=d[it],nt[c]={};v.forEachRecord(i,s.derivedAttributes,function(t){var u,r,i;r=[];for(h in t)n.call(t,h)&&(i=t[h],s.filter(t))&&(i==null&&(i="null"),(u=nt[h])[i]==null&&(u[i]=0),r.push(nt[h][i]++));return r});g=r("<table>",{"class":"pvtUi"}).attr("cellpadding",5);st=r("<td>");ot=r("<select>").addClass("pvtRenderer").appendTo(st).bind("change",function(){return k()});yt=s.renderers;for(c in yt)n.call(yt,c)&&r("<option>").val(c).html(c).appendTo(ot);if(tt=r("<td>").addClass("pvtAxisContainer pvtUnused"),a=function(){var r,n,i;for(i=[],n=0,r=d.length;n<r;n++)y=d[n],t.call(s.hiddenAttributes,y)<0&&i.push(y);return i}(),ht=!1,gt=s.unusedAttrsVertical==="auto"?120:parseInt(s.unusedAttrsVertical),!isNaN(gt)){for(ct=0,rt=0,fi=a.length;rt<fi;rt++)ni=a[rt],ct+=ni.length;ht=ct>gt}s.unusedAttrsVertical===!0||ht?tt.addClass("pvtVertList"):tt.addClass("pvtHorizList");ri=function(n){var u,f,p,e,o,l,c,d,a,v,y,g,it,rt,i;if(c=function(){var t=[];for(h in nt[n])t.push(h);return t}(),l=!1,i=r("<div>").addClass("pvtFilterBox").hide(),i.append(r("<h4>").text(n+" ("+c.length+")")),c.length>s.menuLimit)i.append(r("<p>").html(s.localeStrings.tooMany));else for(f=r("<p>").appendTo(i),f.append(r("<button>",{type:"button"}).html(s.localeStrings.selectAll).bind("click",function(){return i.find("input:visible").prop("checked",!0)})),f.append(r("<button>",{type:"button"}).html(s.localeStrings.selectNone).bind("click",function(){return i.find("input:visible").prop("checked",!1)})),f.append(r("<br>")),f.append(r("<input>",{type:"text",placeholder:s.localeStrings.filterResults,"class":"pvtSearch"}).bind("keyup",function(){var n;return n=r(this).val().toLowerCase(),i.find(".pvtCheckContainer p").each(function(){var t;return t=r(this).text().toLowerCase().indexOf(n),t!==-1?r(this).show():r(this).hide()})})),p=r("<div>").addClass("pvtCheckContainer").appendTo(i),v=c.sort(w(s.sorters,n)),a=0,d=v.length;a<d;a++)h=v[a],rt=nt[n][h],e=r("<label>"),o=!1,s.inclusions[n]?o=t.call(s.inclusions[n],h)<0:s.exclusions[n]&&(o=t.call(s.exclusions[n],h)>=0),l||(l=o),r("<input>").attr("type","checkbox").addClass("pvtFilter").attr("checked",!o).data("filter",[n,h]).appendTo(e),e.append(r("<span>").html(h)),e.append(r("<span>").text(" ("+rt+")")),p.append(r("<p>").append(e));return it=function(){var n;return n=i.find("[type='checkbox']").length-i.find("[type='checkbox']:checked").length,n>0?u.addClass("pvtFilteredAttribute"):u.removeClass("pvtFilteredAttribute"),c.length>s.menuLimit?i.toggle():i.toggle(0,k)},r("<p>").appendTo(i).append(r("<button>",{type:"button"}).text("OK").bind("click",it)),y=function(n){var u,f,t;return t=r(n.currentTarget).position(),u=t.left,f=t.top,i.css({left:u+10,top:f+10}).toggle(),i.find(".pvtSearch").val(""),i.find(".pvtCheckContainer p").show()},g=r("<span>").addClass("pvtTriangle").html(" &#x25BE;").bind("click",y),u=r("<li>").addClass("axis_"+b).append(r("<span>").addClass("pvtAttr").text(n).data("attrName",n).append(g)),l&&u.addClass("pvtFilteredAttribute"),tt.append(u).append(i),u.bind("dblclick",y)};for(b in a)n.call(a,b)&&(y=a[b],ri(y));kt=r("<tr>").appendTo(g);p=r("<select>").addClass("pvtAggregator").bind("change",function(){return k()});pt=s.aggregators;for(c in pt)n.call(pt,c)&&p.append(r("<option>").val(c).html(c));for(r("<td>").addClass("pvtVals").appendTo(kt).append(p).append(r("<br>")),r("<td>").addClass("pvtAxisContainer pvtHorizList pvtCols").appendTo(kt),dt=r("<tr>").appendTo(g),dt.append(r("<td>").addClass("pvtAxisContainer pvtRows").attr("valign","top")),ft=r("<td>").attr("valign","top").addClass("pvtRendererArea").appendTo(dt),s.unusedAttrsVertical===!0||ht?(g.find("tr:nth-child(1)").prepend(st),g.find("tr:nth-child(2)").prepend(tt)):g.prepend(r("<tr>").append(st).append(tt)),this.html(g),wt=s.cols,ut=0,ei=wt.length;ut<ei;ut++)c=wt[ut],this.find(".pvtCols").append(this.find(".axis_"+r.inArray(c,a)));for(bt=s.rows,et=0,oi=bt.length;et<oi;et++)c=bt[et],this.find(".pvtRows").append(this.find(".axis_"+r.inArray(c,a)));s.aggregatorName!=null&&this.find(".pvtAggregator").val(s.aggregatorName);s.rendererName!=null&&this.find(".pvtRenderer").val(s.rendererName);at=!0;si=function(n){return function(){var g,f,o,rt,nt,v,tt,ut,et,y,w,u,d,it,e;if(u={derivedAttributes:s.derivedAttributes,localeStrings:s.localeStrings,rendererOptions:s.rendererOptions,sorters:s.sorters,cols:[],rows:[]},v=(et=s.aggregators[p.val()]([])().numInputs)!=null?et:0,e=[],n.find(".pvtRows li span.pvtAttr").each(function(){return u.rows.push(r(this).data("attrName"))}),n.find(".pvtCols li span.pvtAttr").each(function(){return u.cols.push(r(this).data("attrName"))}),n.find(".pvtVals select.pvtAttrDropdown").each(function(){return v===0?r(this).remove():(v--,r(this).val()!=="")?e.push(r(this).val()):void 0}),v!==0)for(ut=n.find(".pvtVals"),c=w=0,y=v;0<=y?w<y:w>y;c=0<=y?++w:--w){for(nt=r("<select>").addClass("pvtAttrDropdown").append(r("<option>")).bind("change",function(){return k()}),d=0,rt=a.length;d<rt;d++)g=a[d],nt.append(r("<option>").val(g).text(g));ut.append(nt)}if(at&&(e=s.vals,b=0,n.find(".pvtVals select.pvtAttrDropdown").each(function(){return r(this).val(e[b]),b++}),at=!1),u.aggregatorName=p.val(),u.vals=e,u.aggregator=s.aggregators[p.val()](e),u.renderer=s.renderers[ot.val()],f={},n.find("input.pvtFilter").not(":checked").each(function(){var n;return n=r(this).data("filter"),f[n[0]]!=null?f[n[0]].push(n[1]):f[n[0]]=[n[1]]}),o={},n.find("input.pvtFilter:checked").each(function(){var n;return n=r(this).data("filter"),f[n[0]]!=null?o[n[0]]!=null?o[n[0]].push(n[1]):o[n[0]]=[n[1]]:void 0}),u.filter=function(n){var i,r;if(!s.filter(n))return!1;for(h in f)if(i=f[h],r=""+n[h],t.call(i,r)>=0)return!1;return!0},ft.pivot(i,u),tt=r.extend(s,{cols:u.cols,rows:u.rows,vals:e,exclusions:f,inclusions:o,inclusionsInfo:o,aggregatorName:p.val(),rendererName:ot.val()}),n.data("pivotUIOptions",tt),s.autoSortUnusedAttrs&&(it=n.find("td.pvtUnused.pvtAxisContainer"),r(it).children("li").sort(function(n,t){return l(r(n).text(),r(t).text())}).appendTo(it)),ft.css("opacity",1),s.onRefresh!=null)return s.onRefresh(tt)}}(this);k=function(){return function(){return ft.css("opacity",.5),setTimeout(si,10)}}(this);k();this.find(".pvtAxisContainer").sortable({update:function(n,t){if(t.sender==null)return k()},connectWith:this.find(".pvtAxisContainer"),items:"li",placeholder:"pvtPlaceholder"})}catch(hi){ii=hi;typeof console!="undefined"&&console!==null&&console.error(ii.stack);this.html(s.localeStrings.uiRenderError)}return this},r.fn.heatmap=function(n){var h,t,o,s,i,u,c,l,f,e;n==null&&(n="heatmap");l=this.data("numrows");c=this.data("numcols");h=function(n,t,i){var r;return r=function(){switch(n){case"red":return function(n){return"ff"+n+n};case"green":return function(n){return n+"ff"+n};case"blue":return function(n){return""+n+n+"ff"}}}(),function(n){var u,f;return f=255-Math.round(255*(n-t)/(i-t)),u=f.toString(16).split(".")[0],u.length===1&&(u=0+u),r(u)}};t=function(n){return function(t,i){var e,f,u;return f=function(i){return n.find(t).each(function(){var n;return n=r(this).data("value"),n!=null&&isFinite(n)?i(n,r(this)):void 0})},u=[],f(function(n){return u.push(n)}),e=h(i,Math.min.apply(Math,u),Math.max.apply(Math,u)),f(function(n,t){return t.css("background-color","#"+e(n))})}}(this);switch(n){case"heatmap":t(".pvtVal","red");break;case"rowheatmap":for(o=i=0,f=l;0<=f?i<f:i>f;o=0<=f?++i:--i)t(".pvtVal.row"+o,"red");break;case"colheatmap":for(s=u=0,e=c;0<=e?u<e:u>e;s=0<=e?++u:--u)t(".pvtVal.col"+s,"red")}return t(".pvtTotal.rowTotal","red"),t(".pvtTotal.colTotal","red"),this},r.fn.barchart=function(){var i,u,n,e,f,t;for(f=this.data("numrows"),e=this.data("numcols"),i=function(n){return function(t){var i,f,e,u;return i=function(i){return n.find(t).each(function(){var n;return n=r(this).data("value"),n!=null&&isFinite(n)?i(n,r(this)):void 0})},u=[],i(function(n){return u.push(n)}),f=Math.max.apply(Math,u),e=function(n){return 100*n/(1.4*f)},i(function(n,t){var u,i;return u=t.text(),i=r("<div>").css({position:"relative",height:"55px"}),i.append(r("<div>").css({position:"absolute",bottom:0,left:0,right:0,height:e(n)+"%","background-color":"gray"})),i.append(r("<div>").text(u).css({position:"relative","padding-left":"5px","padding-right":"5px"})),t.css({padding:0,"padding-top":"5px","text-align":"center"}).html(i)})}}(this),u=n=0,t=f;0<=t?n<t:n>t;u=0<=t?++n:--n)i(".pvtVal.row"+u);return i(".pvtTotal.colTotal"),this}})}).call(this);
/*
//# sourceMappingURL=pivot.min.js.map
*/